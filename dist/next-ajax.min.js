/*!
 * name: next-ajax
 * url: https://github.com/afeiship/next-ajax
 * version: 1.0.0
 * date: 2019-09-03T01:58:40.540Z
 * license: MIT
 */
!function(){var t=t||this||window||Function("return this")(),e=t.nx||require("next-js-core2"),n=e.Xhr||require("next-xhr"),s=e.param||require("next-param"),o=e.capitalize||require("next-capitalize"),r=e.defaults||require("next-defaults"),i=e.DataTransform||require("next-data-transform"),a=e.XhrHeader||require("next-xhr-header"),u=function(t){return t&&t.data},h=function(t){return t},c={success:0,fail:1,timeout:2,complete:10},p={async:!0,timeout:3e3,contentType:"json",headers:{},onRequest:u,onResponse:h,onSuccess:e.noop,onFail:e.noop,onComplete:e.noop,onTimeout:e.noop},d=e.declare("nx.Ajax",{statics:{STATUS:c,fetch:function(t,e,n,s){var o=new d(t,e,n,s);return o.fetch(),o}},properties:{$success:{get:function(){var t=this.xhr;try{return!t.status&&"file:"==location.protocol||t.status>=200&&t.status<300||304==t.status||navigator.userAgent.indexOf("Safari")>-1&&void 0===t.status}catch(t){}return!1}},$url:{get:function(){var t=this.method,e=this.url;return"GET"===t?e+(e.indexOf("?")>-1?"&":"?")+s(this.data):e}},$data:{get:function(){var t=this.method,e=this.options.contentType,n=i[e](this.data);return"GET"===t?n:null}}},methods:{init:function(t,s,o,r){this.method=(t||"GET").toUpperCase(),this.data=o,this.url=s,this.options=e.mix(null,p,r),this.xhr=n.create(),this.header=new a(this.xhr)},destroy:function(){this.xhr.abort(),this.xhr.onreadystatechange=null},fetch:function(){var n,s,r=!1,i=!1,a=this.options,u=a.contentType,h=this.xhr,c=e.mix({"Content-Type":u},a.headers),p=this,d=null;h.onreadystatechange=function(){4===h.readyState&&(r||(n=p.$success?"success":"fail",a["on"+o(n)](p.response(n)),a.onComplete(p.response("complete"))),i=!0)},h.open(this.method,this.$url,this.options.async),this.header={request:c},s=this.request(),h.send(s),d&&clearTimeout(d),d=t.setTimeout(function(){i||(r=!0,a.onTimeout(p.response("timeout")),a.onComplete(p.response("complete")))},a.timeout)},response:function(t){var e=this.xhr,n=this.options,s=r(c[t],-1);return n.onResponse({status:t,code:s,data:e.responseText,xhr:e})},request:function(){var t=this.options;return t.onRequest({xhr:this.xhr,method:this.method,url:this.$url,data:this.$data,options:t})}}});"undefined"!=typeof module&&module.exports&&(module.exports=d)}();